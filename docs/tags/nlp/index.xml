<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Nlp on ayeung.dev</title>
    <link>/tags/nlp/</link>
    <description>ayeung.dev (Nlp)</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    
      

      
    

    
    <lastBuildDate>Fri, 19 Jun 2020 00:00:00 +0000</lastBuildDate>
    
    <atom:link href="/tags/nlp/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>🤖 Mastering BERT Tokenization and Encoding</title>
      <link>/2020/06/19/bert-tokenization.html</link>
      <pubDate>Fri, 19 Jun 2020 00:00:00 +0000</pubDate>
      
      <guid>/2020/06/19/bert-tokenization.html</guid>
      <description>&lt;p&gt;To use a pre-trained BERT model, we need to convert the input data into an appropriate format so that each sentence can be sent to the pre-trained model to obtain the corresponding embedding. This article introduces how this can be done using modules and functions available in Hugging Face&amp;rsquo;s &lt;code&gt;transformers&lt;/code&gt; package (&lt;a href=&#34;https://huggingface.co/transformers/index.html&#34;&gt;https://huggingface.co/transformers/index.html&lt;/a&gt;).&lt;/p&gt;
&lt;h2 id=&#34;input-representation-in-bert&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#input-representation-in-bert&#34;&gt;
        #
    &lt;/a&gt;
    Input Representation in BERT
&lt;/div&gt;
&lt;/h2&gt;
&lt;p&gt;Let&amp;rsquo;s first try to understand how an input sentence should be represented in BERT. BERT embeddings are trained with two training tasks:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Classification Task&lt;/strong&gt;: to determine which category the input sentence should fall into&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Next Sentence Prediction Task&lt;/strong&gt;: to determine if the second sentence naturally follows the first sentence.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;the-cls-and-sep-tokens&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#the-cls-and-sep-tokens&#34;&gt;
        ##
    &lt;/a&gt;
    The &lt;code&gt;[CLS]&lt;/code&gt; and &lt;code&gt;[SEP]&lt;/code&gt; Tokens
&lt;/div&gt;
&lt;/h3&gt;
&lt;p&gt;For the classification task, a &lt;strong&gt;single&lt;/strong&gt; vector representing the whole input sentence is needed to be fed to a classifier. In BERT, the decision is that the hidden state of the &lt;strong&gt;first token&lt;/strong&gt; is taken to represent the whole sentence. To achieve this, an additional token has to be added manually to the input sentence. In the original implementation, the token &lt;code&gt;[CLS]&lt;/code&gt; is chosen for this purpose.&lt;/p&gt;
&lt;p&gt;In the &amp;ldquo;next sentence prediction&amp;rdquo; task, we need a way to inform the model where does the &lt;strong&gt;first sentence end&lt;/strong&gt;, and where does the &lt;strong&gt;second sentence begin&lt;/strong&gt;. Hence, another artificial token, &lt;code&gt;[SEP]&lt;/code&gt;, is introduced. If we are trying to train a classifier, each input sample will contain only one sentence (or a single text input). In that case, the &lt;code&gt;[SEP]&lt;/code&gt; token will be added to the end of the input text.&lt;/p&gt;
&lt;p&gt;In summary, to preprocess the input text data, the first thing we will have to do is to add the &lt;code&gt;[CLS]&lt;/code&gt; token at the beginning, and the &lt;code&gt;[SEP]&lt;/code&gt; token at the end of each input text.&lt;/p&gt;
&lt;h3 id=&#34;padding-token-pad&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#padding-token-pad&#34;&gt;
        ##
    &lt;/a&gt;
    Padding Token &lt;code&gt;[PAD]&lt;/code&gt;
&lt;/div&gt;
&lt;/h3&gt;
&lt;p&gt;The BERT model receives a fixed length of sentence as input. Usually the maximum length of a sentence depends on the data we are working on. For sentences that are shorter than this maximum length, we will have to add paddings (empty tokens) to the sentences to make up the length. In the original implementation, the token &lt;code&gt;[PAD]&lt;/code&gt; is used to represent paddings to the sentence.&lt;/p&gt;
&lt;h3 id=&#34;converting-tokens-to-ids&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#converting-tokens-to-ids&#34;&gt;
        ##
    &lt;/a&gt;
    Converting Tokens to IDs
&lt;/div&gt;
&lt;/h3&gt;
&lt;p&gt;When the BERT model was trained, each token was given a &lt;strong&gt;unique ID&lt;/strong&gt;. Hence, when we want to use a pre-trained BERT model, we will first need to convert each token in the input sentence into its corresponding unique IDs.&lt;/p&gt;
&lt;p&gt;There is an important point to note when we use a pre-trained model. Since the model is pre-trained on a certain corpus, the &lt;strong&gt;vocabulary&lt;/strong&gt; was also fixed. In other words, when we apply a pre-trained model to some other data, it is possible that some tokens in the new data might not appear in the fixed vocabulary of the pre-trained model. This is commonly known as the &lt;strong&gt;out-of-vocabulary (OOV)&lt;/strong&gt; problem.&lt;/p&gt;
&lt;p&gt;For tokens not appearing in the original vocabulary, it is designed that they should be replaced with a special token &lt;code&gt;[UNK]&lt;/code&gt;, which stands for &lt;strong&gt;unknown&lt;/strong&gt; token.&lt;/p&gt;
&lt;p&gt;However, converting all unseen tokens into &lt;code&gt;[UNK]&lt;/code&gt; will take away a lot of information from the input data. Hence, BERT makes use of a &lt;strong&gt;WordPiece&lt;/strong&gt; algorithm that breaks a word into several &lt;em&gt;subwords&lt;/em&gt;, such that commonly seen subwords can also be represented by the model.&lt;/p&gt;
&lt;p&gt;For example, the word &lt;code&gt;characteristically&lt;/code&gt; does not appear in the original vocabulary. Nevertheless, when we use the BERT tokenizer to tokenize a sentence containing this word, we get something as shown below:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff6ac1&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ff6ac1&#34;&gt;from&lt;/span&gt; transformers &lt;span style=&#34;color:#ff6ac1&#34;&gt;import&lt;/span&gt; BertTokenizer
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff6ac1&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; tz &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; BertTokenizer&lt;span style=&#34;color:#ff6ac1&#34;&gt;.&lt;/span&gt;from_pretrained(&lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34;bert-base-cased&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff6ac1&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; tz&lt;span style=&#34;color:#ff6ac1&#34;&gt;.&lt;/span&gt;convert_tokens_to_ids([&lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34;characteristically&amp;#34;&lt;/span&gt;])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#ff9f43&#34;&gt;100&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff6ac1&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; sent &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34;He remains characteristically confident and optimistic.&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff6ac1&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; tz&lt;span style=&#34;color:#ff6ac1&#34;&gt;.&lt;/span&gt;tokenize(sent)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;He&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;remains&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;characteristic&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;##ally&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;confident&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;and&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;optimistic&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff6ac1&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; tz&lt;span style=&#34;color:#ff6ac1&#34;&gt;.&lt;/span&gt;convert_tokens_to_ids(tz&lt;span style=&#34;color:#ff6ac1&#34;&gt;.&lt;/span&gt;tokenize(sent))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#ff9f43&#34;&gt;1124&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;2606&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;7987&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;2716&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;9588&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;1105&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;24876&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;119&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We can see that the word &lt;code&gt;characteristically&lt;/code&gt; will be converted to the ID &lt;code&gt;100&lt;/code&gt;, which is the ID of the token &lt;code&gt;[UNK]&lt;/code&gt;, if we do not apply the tokenization function of the BERT model.&lt;/p&gt;
&lt;p&gt;The BERT tokenization function, on the other hand, will first breaks the word into two subwoards, namely &lt;code&gt;characteristic&lt;/code&gt; and &lt;code&gt;##ally&lt;/code&gt;, where the first token is a more commonly-seen word (prefix) in a corpus, and the second token is prefixed by two hashes &lt;code&gt;##&lt;/code&gt; to indicate that it is a suffix following some other subwords.&lt;/p&gt;
&lt;p&gt;After this tokenization step, all tokens can be converted into their corresponding IDs.&lt;/p&gt;
&lt;h3 id=&#34;summary&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#summary&#34;&gt;
        ##
    &lt;/a&gt;
    Summary
&lt;/div&gt;
&lt;/h3&gt;
&lt;p&gt;In summary, an input sentence for a &lt;strong&gt;classification task&lt;/strong&gt; will go through the following steps before being fed into the BERT model.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Tokenization: breaking down of the sentence into tokens&lt;/li&gt;
&lt;li&gt;Adding the &lt;code&gt;[CLS]&lt;/code&gt; token at the beginning of the sentence&lt;/li&gt;
&lt;li&gt;Adding the &lt;code&gt;[SEP]&lt;/code&gt; token at the end of the sentence&lt;/li&gt;
&lt;li&gt;Padding the sentence with &lt;code&gt;[PAD]&lt;/code&gt; tokens so that the total length equals to the maximum length&lt;/li&gt;
&lt;li&gt;Converting each token into their corresponding IDs in the model&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;An example of preparing a sentence for input to the BERT model is shown below. For simplicity, we assume the maximum length is 10 in the example below (while in the original model it is set to be 512).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;font-weight:bold&#34;&gt;# Original Sentence
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;font-weight:bold&#34;&gt;&lt;/span&gt;Let&amp;#39;s learn deep learning!
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;font-weight:bold&#34;&gt;# Tokenized Sentence
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;font-weight:bold&#34;&gt;&lt;/span&gt;[&amp;#39;Let&amp;#39;, &amp;#34;&amp;#39;&amp;#34;, &amp;#39;s&amp;#39;, &amp;#39;learn&amp;#39;, &amp;#39;deep&amp;#39;, &amp;#39;learning&amp;#39;, &amp;#39;!&amp;#39;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;font-weight:bold&#34;&gt;# Adding [CLS] and [SEP] Tokens
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;font-weight:bold&#34;&gt;&lt;/span&gt;[&amp;#39;[CLS]&amp;#39;, &amp;#39;Let&amp;#39;, &amp;#34;&amp;#39;&amp;#34;, &amp;#39;s&amp;#39;, &amp;#39;learn&amp;#39;, &amp;#39;deep&amp;#39;, &amp;#39;learning&amp;#39;, &amp;#39;!&amp;#39;, &amp;#39;[SEP]&amp;#39;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;font-weight:bold&#34;&gt;# Padding
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;font-weight:bold&#34;&gt;&lt;/span&gt;[&amp;#39;[CLS]&amp;#39;, &amp;#39;Let&amp;#39;, &amp;#34;&amp;#39;&amp;#34;, &amp;#39;s&amp;#39;, &amp;#39;learn&amp;#39;, &amp;#39;deep&amp;#39;, &amp;#39;learning&amp;#39;, &amp;#39;!&amp;#39;, &amp;#39;[SEP]&amp;#39;, &amp;#39;[PAD]&amp;#39;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;font-weight:bold&#34;&gt;# Converting to IDs
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;font-weight:bold&#34;&gt;&lt;/span&gt;[101, 2421, 112, 188, 3858, 1996, 3776, 106, 102, 0]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;tokenization-using-the-transformers-package&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#tokenization-using-the-transformers-package&#34;&gt;
        #
    &lt;/a&gt;
    Tokenization using the transformers Package
&lt;/div&gt;
&lt;/h2&gt;
&lt;p&gt;While there are quite a number of steps to transform an input sentence into the appropriate representation, we can use the functions provided by the &lt;code&gt;transformers&lt;/code&gt; package to help us perform the tokenization and transformation easily. In particular, we can use the function &lt;code&gt;encode_plus&lt;/code&gt;, which does the following in one go:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Tokenize the input sentence&lt;/li&gt;
&lt;li&gt;Add the &lt;code&gt;[CLS]&lt;/code&gt; and &lt;code&gt;[SEP]&lt;/code&gt; tokens.&lt;/li&gt;
&lt;li&gt;Pad or truncate the sentence to the maximum length allowed&lt;/li&gt;
&lt;li&gt;Encode the tokens into their corresponding IDs
Pad or truncate all sentences to the same length.&lt;/li&gt;
&lt;li&gt;Create the attention masks which explicitly differentiate real tokens from &lt;code&gt;[PAD]&lt;/code&gt; tokens&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The following codes shows how this can be done.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# Import tokenizer from transformers package&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff6ac1&#34;&gt;from&lt;/span&gt; transformers &lt;span style=&#34;color:#ff6ac1&#34;&gt;import&lt;/span&gt; BertTokenizer
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# Load the tokenizer of the &amp;#34;bert-base-cased&amp;#34; pretrained model&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# See https://huggingface.co/transformers/pretrained_models.html for other models&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tz &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; BertTokenizer&lt;span style=&#34;color:#ff6ac1&#34;&gt;.&lt;/span&gt;from_pretrained(&lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34;bert-base-cased&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# The senetence to be encoded&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sent &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34;Let&amp;#39;s learn deep learning!&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# Encode the sentence&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;encoded &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; tz&lt;span style=&#34;color:#ff6ac1&#34;&gt;.&lt;/span&gt;encode_plus(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    text&lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt;sent,  &lt;span style=&#34;color:#78787e&#34;&gt;# the sentence to be encoded&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    add_special_tokens&lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ff6ac1&#34;&gt;True&lt;/span&gt;,  &lt;span style=&#34;color:#78787e&#34;&gt;# Add [CLS] and [SEP]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    max_length &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ff9f43&#34;&gt;64&lt;/span&gt;,  &lt;span style=&#34;color:#78787e&#34;&gt;# maximum length of a sentence&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    pad_to_max_length&lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ff6ac1&#34;&gt;True&lt;/span&gt;,  &lt;span style=&#34;color:#78787e&#34;&gt;# Add [PAD]s&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    return_attention_mask &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ff6ac1&#34;&gt;True&lt;/span&gt;,  &lt;span style=&#34;color:#78787e&#34;&gt;# Generate the attention mask&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    return_tensors &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;pt&amp;#39;&lt;/span&gt;,  &lt;span style=&#34;color:#78787e&#34;&gt;# ask the function to return PyTorch tensors&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# Get the input IDs and attention mask in tensor format&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;input_ids &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; encoded[&lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;input_ids&amp;#39;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;attn_mask &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; encoded[&lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;attention_mask&amp;#39;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;After executing the codes above, we will have the following content for the &lt;code&gt;input_ids&lt;/code&gt; and &lt;code&gt;attn_mask&lt;/code&gt; variables:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff6ac1&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ff5c57&#34;&gt;input&lt;/span&gt;&lt;span style=&#34;color:#ff6ac1&#34;&gt;-&lt;/span&gt;ids
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tensor([[ &lt;span style=&#34;color:#ff9f43&#34;&gt;101&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;2421&lt;/span&gt;,  &lt;span style=&#34;color:#ff9f43&#34;&gt;112&lt;/span&gt;,  &lt;span style=&#34;color:#ff9f43&#34;&gt;188&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;3858&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;1996&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;3776&lt;/span&gt;,  &lt;span style=&#34;color:#ff9f43&#34;&gt;106&lt;/span&gt;,  &lt;span style=&#34;color:#ff9f43&#34;&gt;102&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,    &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;]])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff6ac1&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff6ac1&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; attn_mask
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tensor([[&lt;span style=&#34;color:#ff9f43&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ff9f43&#34;&gt;0&lt;/span&gt;]])
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The &lt;strong&gt;&amp;ldquo;attention mask&amp;rdquo;&lt;/strong&gt; tells the model which tokens should be attended to and which (the &lt;code&gt;[PAD]&lt;/code&gt; tokens) should not (see the &lt;a href=&#34;https://huggingface.co/transformers/glossary.html#attention-mask&#34;&gt;documentation&lt;/a&gt; for more detail). It will be needed when we feed the input into the BERT model.&lt;/p&gt;
&lt;h2 id=&#34;reference&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#reference&#34;&gt;
        #
    &lt;/a&gt;
    Reference
&lt;/div&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Devlin et al. 2018. &lt;a href=&#34;https://arxiv.org/abs/1810.04805&#34;&gt;BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;BERT - transformers documentation: &lt;a href=&#34;https://huggingface.co/transformers/model_doc/bert.html&#34;&gt;https://huggingface.co/transformers/model_doc/bert.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
    <item>
      <title>🐍 Effortlessly Create N-Grams from Text in Python</title>
      <link>/2018/06/03/generating-ngrams.html</link>
      <pubDate>Sun, 03 Jun 2018 00:00:00 +0000</pubDate>
      
      <guid>/2018/06/03/generating-ngrams.html</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/N-gram&#34;&gt;N-grams&lt;/a&gt; are contiguous sequences of n-items in a sentence. N can be 1, 2 or any other positive integers, although usually we do not consider very large N because those n-grams rarely appears in many different places.&lt;/p&gt;
&lt;p&gt;When performing machine learning tasks related to natural language processing, we usually need to generate n-grams from input sentences. For example, in text classification tasks, in addition to using each individual token found in the corpus, we may want to add bi-grams or tri-grams as features to represent our documents. This post describes several different ways to generate n-grams quickly from input sentences in Python.&lt;/p&gt;
&lt;h2 id=&#34;the-pure-python-way&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#the-pure-python-way&#34;&gt;
        #
    &lt;/a&gt;
    The Pure Python Way
&lt;/div&gt;
&lt;/h2&gt;
&lt;p&gt;In general, an input sentence is just a string of characters in Python. We can use build in functions in Python to generate n-grams quickly. Let&amp;rsquo;s take the following sentence as a sample input:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;s &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#5af78e&#34;&gt;    Natural-language processing (NLP) is an area of
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#5af78e&#34;&gt;    computer science and artificial intelligence
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#5af78e&#34;&gt;    concerned with the interactions between computers
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#5af78e&#34;&gt;    and human (natural) languages.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;If we want to generate a list of bi-grams from the above sentence, the expected output would be something like below (depending on how do we want to treat the punctuations, the desired output can be different):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34;natural language&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34;language processing&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34;processing nlp&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34;nlp is&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34;is an&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34;an area&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff6ac1&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The following function can be used to achieve this:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff6ac1&#34;&gt;import&lt;/span&gt; re
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff6ac1&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#57c7ff&#34;&gt;generate_ngrams&lt;/span&gt;(s, n):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#78787e&#34;&gt;# Convert to lowercases&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    s &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; s&lt;span style=&#34;color:#ff6ac1&#34;&gt;.&lt;/span&gt;lower()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#78787e&#34;&gt;# Replace all none alphanumeric characters with spaces&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    s &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; re&lt;span style=&#34;color:#ff6ac1&#34;&gt;.&lt;/span&gt;sub(&lt;span style=&#34;color:#5af78e&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;[^a-zA-Z0-9\s]&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;, s)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#78787e&#34;&gt;# Break sentence in the token, remove empty tokens&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    tokens &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; [token &lt;span style=&#34;color:#ff6ac1&#34;&gt;for&lt;/span&gt; token &lt;span style=&#34;color:#ff6ac1&#34;&gt;in&lt;/span&gt; s&lt;span style=&#34;color:#ff6ac1&#34;&gt;.&lt;/span&gt;split(&lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#ff6ac1&#34;&gt;if&lt;/span&gt; token &lt;span style=&#34;color:#ff6ac1&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#78787e&#34;&gt;# Use the zip function to help us generate n-grams&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#78787e&#34;&gt;# Concatentate the tokens into ngrams and return&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    ngrams &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ff5c57&#34;&gt;zip&lt;/span&gt;(&lt;span style=&#34;color:#ff6ac1&#34;&gt;*&lt;/span&gt;[token[i:] &lt;span style=&#34;color:#ff6ac1&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#ff6ac1&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color:#ff5c57&#34;&gt;range&lt;/span&gt;(n)])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff6ac1&#34;&gt;return&lt;/span&gt; [&lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#ff6ac1&#34;&gt;.&lt;/span&gt;join(ngram) &lt;span style=&#34;color:#ff6ac1&#34;&gt;for&lt;/span&gt; ngram &lt;span style=&#34;color:#ff6ac1&#34;&gt;in&lt;/span&gt; ngrams]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Applying the above function to the sentence, with &lt;code&gt;n=5&lt;/code&gt;, gives the following output:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff6ac1&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; generate_ngrams(s, n&lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ff9f43&#34;&gt;5&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;natural language processing nlp is&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;language processing nlp is an&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;processing nlp is an area&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;nlp is an area of&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;is an area of computer&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;an area of computer science&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;area of computer science and&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;of computer science and artificial&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;computer science and artificial intelligence&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;science and artificial intelligence concerned&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;and artificial intelligence concerned with&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;artificial intelligence concerned with the&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;intelligence concerned with the interactions&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;concerned with the interactions between&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;with the interactions between computers&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;the interactions between computers and&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;interactions between computers and human&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;between computers and human natural&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;computers and human natural languages&amp;#39;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The above function makes use of the &lt;code&gt;zip&lt;/code&gt; function, which creates a generator that aggregates elements from multiple lists (or iterables in genera). The blocks of codes and comments below offer some more explanation of the usage:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# Sample sentence&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;s &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34;one two three four five&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tokens &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; s&lt;span style=&#34;color:#ff6ac1&#34;&gt;.&lt;/span&gt;split(&lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# tokens = [&amp;#34;one&amp;#34;, &amp;#34;two&amp;#34;, &amp;#34;three&amp;#34;, &amp;#34;four&amp;#34;, &amp;#34;five&amp;#34;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sequences &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; [tokens[i:] &lt;span style=&#34;color:#ff6ac1&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#ff6ac1&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color:#ff5c57&#34;&gt;range&lt;/span&gt;(&lt;span style=&#34;color:#ff9f43&#34;&gt;3&lt;/span&gt;)]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# The above will generate sequences of tokens starting&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# from different elements of the list of tokens.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# The parameter in the range() function controls&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# how many sequences to generate.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# sequences = [&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;#   [&amp;#39;one&amp;#39;, &amp;#39;two&amp;#39;, &amp;#39;three&amp;#39;, &amp;#39;four&amp;#39;, &amp;#39;five&amp;#39;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;#   [&amp;#39;two&amp;#39;, &amp;#39;three&amp;#39;, &amp;#39;four&amp;#39;, &amp;#39;five&amp;#39;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;#   [&amp;#39;three&amp;#39;, &amp;#39;four&amp;#39;, &amp;#39;five&amp;#39;]]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;bigrams &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ff5c57&#34;&gt;zip&lt;/span&gt;(&lt;span style=&#34;color:#ff6ac1&#34;&gt;*&lt;/span&gt;sequences)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# The zip function takes the sequences as a list of inputs&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# (using the * operator, this is equivalent to&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# zip(sequences[0], sequences[1], sequences[2]).&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# Each tuple it returns will contain one element from&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# each of the sequences.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# To inspect the content of bigrams, try:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# print(list(bigrams))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# which will give the following:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# [&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;#   (&amp;#39;one&amp;#39;, &amp;#39;two&amp;#39;, &amp;#39;three&amp;#39;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;#   (&amp;#39;two&amp;#39;, &amp;#39;three&amp;#39;, &amp;#39;four&amp;#39;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;#   (&amp;#39;three&amp;#39;, &amp;#39;four&amp;#39;, &amp;#39;five&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# ]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# Note: even though the first sequence has 5 elements,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# zip will stop after returning 3 tuples, because the&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# last sequence only has 3 elements. In other words,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# the zip function automatically handles the ending of&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#78787e&#34;&gt;# the n-gram generation.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;using-nltk&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#using-nltk&#34;&gt;
        #
    &lt;/a&gt;
    Using NLTK
&lt;/div&gt;
&lt;/h2&gt;
&lt;p&gt;Instead of using pure Python functions, we can also get help from some natural language processing libraries such as the &lt;a href=&#34;https://www.nltk.org/&#34;&gt;Natural Language Toolkit (NLTK)&lt;/a&gt;. In particular, nltk has the &lt;code&gt;ngrams&lt;/code&gt; function that returns a generator of n-grams given a tokenized sentence. (See the documentaion of the function &lt;a href=&#34;http://www.nltk.org/api/nltk.html#nltk.util.ngrams&#34;&gt;here&lt;/a&gt;)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff6ac1&#34;&gt;import&lt;/span&gt; re
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff6ac1&#34;&gt;from&lt;/span&gt; nltk.util &lt;span style=&#34;color:#ff6ac1&#34;&gt;import&lt;/span&gt; ngrams
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;s &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; s&lt;span style=&#34;color:#ff6ac1&#34;&gt;.&lt;/span&gt;lower()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;s &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; re&lt;span style=&#34;color:#ff6ac1&#34;&gt;.&lt;/span&gt;sub(&lt;span style=&#34;color:#5af78e&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39;[^a-zA-Z0-9\s]&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;, s)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tokens &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; [token &lt;span style=&#34;color:#ff6ac1&#34;&gt;for&lt;/span&gt; token &lt;span style=&#34;color:#ff6ac1&#34;&gt;in&lt;/span&gt; s&lt;span style=&#34;color:#ff6ac1&#34;&gt;.&lt;/span&gt;split(&lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#ff6ac1&#34;&gt;if&lt;/span&gt; token &lt;span style=&#34;color:#ff6ac1&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#5af78e&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;output &lt;span style=&#34;color:#ff6ac1&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ff5c57&#34;&gt;list&lt;/span&gt;(ngrams(tokens, &lt;span style=&#34;color:#ff9f43&#34;&gt;5&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The above block of code will generate the same output as the function &lt;code&gt;generate_ngrams()&lt;/code&gt; as shown above.&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>
