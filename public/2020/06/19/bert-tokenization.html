<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='To use a pre-trained BERT model, we need to convert the input data into an appropriate format so that each sentence can be sent to the pre-trained model to obtain the corresponding embedding. This article introduces how this can be done using modules and functions available in Hugging Face&amp;rsquo;s transformers package (https://huggingface.co/transformers/index.html).
Input Representation in BERT Let&amp;rsquo;s first try to understand how an input sentence should be represented in BERT. BERT embeddings are trained with two training tasks:'>
<title>ü§ñ Mastering BERT Tokenization and Encoding</title>

<link rel='canonical' href='https://albertauyeung.github.io/2020/06/19/bert-tokenization.html'>

<link rel="stylesheet" href="/scss/style.min.ebb0feb1238c5f4c8e14c9febf04dc409a6cacb74e106e0c4e417e5eb085669e.css"><meta property='og:title' content='ü§ñ Mastering BERT Tokenization and Encoding'>
<meta property='og:description' content='To use a pre-trained BERT model, we need to convert the input data into an appropriate format so that each sentence can be sent to the pre-trained model to obtain the corresponding embedding. This article introduces how this can be done using modules and functions available in Hugging Face&amp;rsquo;s transformers package (https://huggingface.co/transformers/index.html).
Input Representation in BERT Let&amp;rsquo;s first try to understand how an input sentence should be represented in BERT. BERT embeddings are trained with two training tasks:'>
<meta property='og:url' content='https://albertauyeung.github.io/2020/06/19/bert-tokenization.html'>
<meta property='og:site_name' content='Albert Au Yeung'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='python' /><meta property='article:tag' content='machine learning' /><meta property='article:tag' content='nlp' /><meta property='article:tag' content='deep learning' /><meta property='article:tag' content='bert' /><meta property='article:published_time' content='2020-06-19T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2020-06-19T00:00:00&#43;00:00'/>
<meta name="twitter:title" content="ü§ñ Mastering BERT Tokenization and Encoding">
<meta name="twitter:description" content="To use a pre-trained BERT model, we need to convert the input data into an appropriate format so that each sentence can be sent to the pre-trained model to obtain the corresponding embedding. This article introduces how this can be done using modules and functions available in Hugging Face&amp;rsquo;s transformers package (https://huggingface.co/transformers/index.html).
Input Representation in BERT Let&amp;rsquo;s first try to understand how an input sentence should be represented in BERT. BERT embeddings are trained with two training tasks:">
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "light");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/avatar_hu504580e4e0594bf3f7bf7b76af994632_241575_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Albert Au Yeung</a></h1>
            <h2 class="site-description">AI/ML Engineer</h2>
        </div>
    </header><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/page/about' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/page/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/page/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#input-representation-in-bert">Input Representation in BERT</a>
      <ul>
        <li><a href="#the-cls-and-sep-tokens">The <code>[CLS]</code> and <code>[SEP]</code> Tokens</a></li>
        <li><a href="#padding-token-pad">Padding Token <code>[PAD]</code></a></li>
        <li><a href="#converting-tokens-to-ids">Converting Tokens to IDs</a></li>
        <li><a href="#summary">Summary</a></li>
      </ul>
    </li>
    <li><a href="#tokenization-using-the-transformers-package">Tokenization using the transformers Package</a></li>
    <li><a href="#reference">Reference</a></li>
  </ul>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/2020/06/19/bert-tokenization.html">ü§ñ Mastering BERT Tokenization and Encoding</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jun 19, 2020</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    7 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>To use a pre-trained BERT model, we need to convert the input data into an appropriate format so that each sentence can be sent to the pre-trained model to obtain the corresponding embedding. This article introduces how this can be done using modules and functions available in Hugging Face&rsquo;s <code>transformers</code> package (<a class="link" href="https://huggingface.co/transformers/index.html"  target="_blank" rel="noopener"
    >https://huggingface.co/transformers/index.html</a>).</p>
<h2 id="input-representation-in-bert">Input Representation in BERT</h2>
<p>Let&rsquo;s first try to understand how an input sentence should be represented in BERT. BERT embeddings are trained with two training tasks:</p>
<ol>
<li><strong>Classification Task</strong>: to determine which category the input sentence should fall into</li>
<li><strong>Next Sentence Prediction Task</strong>: to determine if the second sentence naturally follows the first sentence.</li>
</ol>
<h3 id="the-cls-and-sep-tokens">The <code>[CLS]</code> and <code>[SEP]</code> Tokens</h3>
<p>For the classification task, a <strong>single</strong> vector representing the whole input sentence is needed to be fed to a classifier. In BERT, the decision is that the hidden state of the <strong>first token</strong> is taken to represent the whole sentence. To achieve this, an additional token has to be added manually to the input sentence. In the original implementation, the token <code>[CLS]</code> is chosen for this purpose.</p>
<p>In the &ldquo;next sentence prediction&rdquo; task, we need a way to inform the model where does the <strong>first sentence end</strong>, and where does the <strong>second sentence begin</strong>. Hence, another artificial token, <code>[SEP]</code>, is introduced. If we are trying to train a classifier, each input sample will contain only one sentence (or a single text input). In that case, the <code>[SEP]</code> token will be added to the end of the input text.</p>
<p>In summary, to preprocess the input text data, the first thing we will have to do is to add the <code>[CLS]</code> token at the beginning, and the <code>[SEP]</code> token at the end of each input text.</p>
<h3 id="padding-token-pad">Padding Token <code>[PAD]</code></h3>
<p>The BERT model receives a fixed length of sentence as input. Usually the maximum length of a sentence depends on the data we are working on. For sentences that are shorter than this maximum length, we will have to add paddings (empty tokens) to the sentences to make up the length. In the original implementation, the token <code>[PAD]</code> is used to represent paddings to the sentence.</p>
<h3 id="converting-tokens-to-ids">Converting Tokens to IDs</h3>
<p>When the BERT model was trained, each token was given a <strong>unique ID</strong>. Hence, when we want to use a pre-trained BERT model, we will first need to convert each token in the input sentence into its corresponding unique IDs.</p>
<p>There is an important point to note when we use a pre-trained model. Since the model is pre-trained on a certain corpus, the <strong>vocabulary</strong> was also fixed. In other words, when we apply a pre-trained model to some other data, it is possible that some tokens in the new data might not appear in the fixed vocabulary of the pre-trained model. This is commonly known as the <strong>out-of-vocabulary (OOV)</strong> problem.</p>
<p>For tokens not appearing in the original vocabulary, it is designed that they should be replaced with a special token <code>[UNK]</code>, which stands for <strong>unknown</strong> token.</p>
<p>However, converting all unseen tokens into <code>[UNK]</code> will take away a lot of information from the input data. Hence, BERT makes use of a <strong>WordPiece</strong> algorithm that breaks a word into several <em>subwords</em>, such that commonly seen subwords can also be represented by the model.</p>
<p>For example, the word <code>characteristically</code> does not appear in the original vocabulary. Nevertheless, when we use the BERT tokenizer to tokenize a sentence containing this word, we get something as shown below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#f92672">from</span> transformers <span style="color:#f92672">import</span> BertTokenizer
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> tz <span style="color:#f92672">=</span> BertTokenizer<span style="color:#f92672">.</span>from_pretrained(<span style="color:#e6db74">&#34;bert-base-cased&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> tz<span style="color:#f92672">.</span>convert_tokens_to_ids([<span style="color:#e6db74">&#34;characteristically&#34;</span>])
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">100</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> sent <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;He remains characteristically confident and optimistic.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> tz<span style="color:#f92672">.</span>tokenize(sent)
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#39;He&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;remains&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;characteristic&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;##ally&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;confident&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;and&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;optimistic&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;.&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> tz<span style="color:#f92672">.</span>convert_tokens_to_ids(tz<span style="color:#f92672">.</span>tokenize(sent))
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">1124</span>, <span style="color:#ae81ff">2606</span>, <span style="color:#ae81ff">7987</span>, <span style="color:#ae81ff">2716</span>, <span style="color:#ae81ff">9588</span>, <span style="color:#ae81ff">1105</span>, <span style="color:#ae81ff">24876</span>, <span style="color:#ae81ff">119</span>]
</span></span></code></pre></div><p>We can see that the word <code>characteristically</code> will be converted to the ID <code>100</code>, which is the ID of the token <code>[UNK]</code>, if we do not apply the tokenization function of the BERT model.</p>
<p>The BERT tokenization function, on the other hand, will first breaks the word into two subwoards, namely <code>characteristic</code> and <code>##ally</code>, where the first token is a more commonly-seen word (prefix) in a corpus, and the second token is prefixed by two hashes <code>##</code> to indicate that it is a suffix following some other subwords.</p>
<p>After this tokenization step, all tokens can be converted into their corresponding IDs.</p>
<h3 id="summary">Summary</h3>
<p>In summary, an input sentence for a <strong>classification task</strong> will go through the following steps before being fed into the BERT model.</p>
<ol>
<li>Tokenization: breaking down of the sentence into tokens</li>
<li>Adding the <code>[CLS]</code> token at the beginning of the sentence</li>
<li>Adding the <code>[SEP]</code> token at the end of the sentence</li>
<li>Padding the sentence with <code>[PAD]</code> tokens so that the total length equals to the maximum length</li>
<li>Converting each token into their corresponding IDs in the model</li>
</ol>
<p>An example of preparing a sentence for input to the BERT model is shown below. For simplicity, we assume the maximum length is 10 in the example below (while in the original model it is set to be 512).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span># Original Sentence
</span></span><span style="display:flex;"><span>Let&#39;s learn deep learning!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Tokenized Sentence
</span></span><span style="display:flex;"><span>[&#39;Let&#39;, &#34;&#39;&#34;, &#39;s&#39;, &#39;learn&#39;, &#39;deep&#39;, &#39;learning&#39;, &#39;!&#39;]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Adding [CLS] and [SEP] Tokens
</span></span><span style="display:flex;"><span>[&#39;[CLS]&#39;, &#39;Let&#39;, &#34;&#39;&#34;, &#39;s&#39;, &#39;learn&#39;, &#39;deep&#39;, &#39;learning&#39;, &#39;!&#39;, &#39;[SEP]&#39;]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Padding
</span></span><span style="display:flex;"><span>[&#39;[CLS]&#39;, &#39;Let&#39;, &#34;&#39;&#34;, &#39;s&#39;, &#39;learn&#39;, &#39;deep&#39;, &#39;learning&#39;, &#39;!&#39;, &#39;[SEP]&#39;, &#39;[PAD]&#39;]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Converting to IDs
</span></span><span style="display:flex;"><span>[101, 2421, 112, 188, 3858, 1996, 3776, 106, 102, 0]
</span></span></code></pre></div><h2 id="tokenization-using-the-transformers-package">Tokenization using the transformers Package</h2>
<p>While there are quite a number of steps to transform an input sentence into the appropriate representation, we can use the functions provided by the <code>transformers</code> package to help us perform the tokenization and transformation easily. In particular, we can use the function <code>encode_plus</code>, which does the following in one go:</p>
<ol>
<li>Tokenize the input sentence</li>
<li>Add the <code>[CLS]</code> and <code>[SEP]</code> tokens.</li>
<li>Pad or truncate the sentence to the maximum length allowed</li>
<li>Encode the tokens into their corresponding IDs
Pad or truncate all sentences to the same length.</li>
<li>Create the attention masks which explicitly differentiate real tokens from <code>[PAD]</code> tokens</li>
</ol>
<p>The following codes shows how this can be done.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Import tokenizer from transformers package</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> transformers <span style="color:#f92672">import</span> BertTokenizer
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Load the tokenizer of the &#34;bert-base-cased&#34; pretrained model</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># See https://huggingface.co/transformers/pretrained_models.html for other models</span>
</span></span><span style="display:flex;"><span>tz <span style="color:#f92672">=</span> BertTokenizer<span style="color:#f92672">.</span>from_pretrained(<span style="color:#e6db74">&#34;bert-base-cased&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The senetence to be encoded</span>
</span></span><span style="display:flex;"><span>sent <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Let&#39;s learn deep learning!&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Encode the sentence</span>
</span></span><span style="display:flex;"><span>encoded <span style="color:#f92672">=</span> tz<span style="color:#f92672">.</span>encode_plus(
</span></span><span style="display:flex;"><span>    text<span style="color:#f92672">=</span>sent,  <span style="color:#75715e"># the sentence to be encoded</span>
</span></span><span style="display:flex;"><span>    add_special_tokens<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,  <span style="color:#75715e"># Add [CLS] and [SEP]</span>
</span></span><span style="display:flex;"><span>    max_length <span style="color:#f92672">=</span> <span style="color:#ae81ff">64</span>,  <span style="color:#75715e"># maximum length of a sentence</span>
</span></span><span style="display:flex;"><span>    pad_to_max_length<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,  <span style="color:#75715e"># Add [PAD]s</span>
</span></span><span style="display:flex;"><span>    return_attention_mask <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>,  <span style="color:#75715e"># Generate the attention mask</span>
</span></span><span style="display:flex;"><span>    return_tensors <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;pt&#39;</span>,  <span style="color:#75715e"># ask the function to return PyTorch tensors</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get the input IDs and attention mask in tensor format</span>
</span></span><span style="display:flex;"><span>input_ids <span style="color:#f92672">=</span> encoded[<span style="color:#e6db74">&#39;input_ids&#39;</span>]
</span></span><span style="display:flex;"><span>attn_mask <span style="color:#f92672">=</span> encoded[<span style="color:#e6db74">&#39;attention_mask&#39;</span>]
</span></span></code></pre></div><p>After executing the codes above, we will have the following content for the <code>input_ids</code> and <code>attn_mask</code> variables:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> input<span style="color:#f92672">-</span>ids
</span></span><span style="display:flex;"><span>tensor([[ <span style="color:#ae81ff">101</span>, <span style="color:#ae81ff">2421</span>,  <span style="color:#ae81ff">112</span>,  <span style="color:#ae81ff">188</span>, <span style="color:#ae81ff">3858</span>, <span style="color:#ae81ff">1996</span>, <span style="color:#ae81ff">3776</span>,  <span style="color:#ae81ff">106</span>,  <span style="color:#ae81ff">102</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>,    <span style="color:#ae81ff">0</span>]])
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> attn_mask
</span></span><span style="display:flex;"><span>tensor([[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>         <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>]])
</span></span></code></pre></div><p>The <strong>&ldquo;attention mask&rdquo;</strong> tells the model which tokens should be attended to and which (the <code>[PAD]</code> tokens) should not (see the <a class="link" href="https://huggingface.co/transformers/glossary.html#attention-mask"  target="_blank" rel="noopener"
    >documentation</a> for more detail). It will be needed when we feed the input into the BERT model.</p>
<h2 id="reference">Reference</h2>
<ul>
<li>Devlin et al. 2018. <a class="link" href="https://arxiv.org/abs/1810.04805"  target="_blank" rel="noopener"
    >BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding</a></li>
<li>BERT - transformers documentation: <a class="link" href="https://huggingface.co/transformers/model_doc/bert.html"  target="_blank" rel="noopener"
    >https://huggingface.co/transformers/model_doc/bert.html</a></li>
</ul>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/python/">python</a>
        
            <a href="/tags/machine-learning/">machine learning</a>
        
            <a href="/tags/nlp/">nlp</a>
        
            <a href="/tags/deep-learning/">deep learning</a>
        
            <a href="/tags/bert/">bert</a>
        
    </section>


    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/2018/11/23/pyconhk-ml-deploy.html">
        
        

        <div class="article-details">
            <h2 class="article-title">üöÄ Deploying ML Models in Python - A PyCon HK 2018 Talk</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/2018/06/03/generating-ngrams.html">
        
        

        <div class="article-details">
            <h2 class="article-title">üêç Effortlessly Create N-Grams from Text in Python</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/2017/11/05/pyconhk-gbm.html">
        
        

        <div class="article-details">
            <h2 class="article-title">üöÄ Using Gradient Boosting Machines in Python - A PyCon HK 2017 Talk</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/2017/06/17/python-sequence-labelling-with-crf.html">
        
        

        <div class="article-details">
            <h2 class="article-title">üîç Performing Sequence Labelling using CRF in Python</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/2017/04/23/python-matrix-factorization.html">
        
        

        <div class="article-details">
            <h2 class="article-title">üî• Matrix Factorization: A Simple Tutorial and Implementation in Python</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2024 Albert Au Yeung
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.21.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
